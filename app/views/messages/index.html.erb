<p id="notice" style="margin-top: 10%"> <% notice %></p>

<div class="display_mess">
  <h1>Messages</h1>
  <table class="table table-striped table-bordered" style="width:100%">
    <th> <%= current_user.last_name.capitalize %></th>
    <th>Administrateur</th>
    <th id="date_message">Date</th>
    <tbody>
      <% @messages_to_display = []%>
      <% @messages.each do |message| %>
      <% if message.user_id == current_user.id %>
      <%@messages_to_display << message %>
      <% end %>
      <% end %>
      <% @admin.messages.each do |message| %>
      <% if message.dest_id == current_user.id %>
      <%@messages_to_display << message %>
      <% end %>
      <% end %>
      <br>
      <tr>
        <% @messages_to_display.each do |message| %>
        <% if message.user_id != current_user.id %>
        <td></td>
        <td><%= message.content %></td>
        <% else %>
        <td><%= message.content %></td>
        <td></td>
        <%end%>
        <td><%=message.created_at.strftime("%d/%m/%Y %i:%M%p")%></td>
    </tr>
    <% end %>
</tbody>
</table>
</div>



<div class="form_mess">
  <%= form_with(model: @message, local: true) do |form| %>
  <div class="field">
    <%= form.label :content %>
    <%= form.text_area :content, id: 'message_tag' %>
    <div class="actions">
      <%= form.submit %>
  </div>
  <% end %>
</div>
</div>




<script>
    $(document).ready(function () {
       var table = $('table');
       $('#date_message')
       .wrapInner('<span title="sort this column"/>')
       .each(function(){
          var th = $(this),
          thIndex = th.index(),
          inverse = false;
          th.click(function(){
            table.find('td').filter(function(){
              return $(this).index() === thIndex;
          }).sortElements(function(a, b){
              return $.text([a]) > $.text([b]) ?
              inverse ? -1 : 1
              : inverse ? 1 : -1;
          }, function(){
            return this.parentNode; 
        });
          inverse = !inverse;
      });
      });
   });
</script>





<script>


    $(document).ready(function () {
      $('#dtBasicExample').DataTable({
    "ordering": false // false to disable sorting (or any other option)
});
      $('.dataTables_length').addClass('bs-select');
  });


</script>

